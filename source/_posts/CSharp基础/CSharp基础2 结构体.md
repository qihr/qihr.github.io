---
title: CSharp基础2 结构体
tags: [CSharp]
categories: Program
date: 2020-02-19 23:50:57 
---

结构体相关内容 

<!-- more -->

## 1.1 结构

### 1.1.1概述

对结构进行分配（注意书上说的是分配不是创建）比创建类的实例开销小，所以使用结构代替类有时可以提高性能，但要注意装箱和拆箱的代价。

预定义的简单类型（int short）等，尽管在.net和c#中是为原始类型，但实际上在.net中都实现为结构。

一些注意的点：

- 结构可以有实力构造函数和静态构造函数，但不允许有析构函数。
- 结构的赋值是复制的。
- 结构可以被分布声明，也可以实现接口。
- 不允许在结构中初始化字段。
- 如果结构需要作为引用类型对象，则需要创建装箱的副本。因为他是值类型的。

### 1.1.2 结构和类的不同

- 类是引用类型，结构是值类型。
- 结构是隐式密封的，这意味着它们不能被派生。
- 结构本身派生自system.valuetype，system.valuetype派生自object。
- 结构只能使用new和override修饰符，当创建一个和基类system.valuetype成员相同名称时使用。

### 1.1.3 结构体的构造方法

c#隐式为结构提供无参构造函数，并会把每个成员设置为该类型的默认值，值类型是默认值，引用类型设置为null。预定义的无参构造方法不能被删除和重定义，但是可以创建其他有参的构造方法，和类是不同的，类只在没有其他构造函数时隐式提供。

调用构造方法需要使用new运算符，即使不从堆中分配内存也要使用new运算符。

如果不适用new运算符，则需要：

- 在显示设置数据成员后，才能使用值。
- 对所有数据成员赋值后，才能调用任何函数成员。

##### 静态构造方法

静态构造函数可以初始化静态数据成员，但不能引用实例成员。和类的静态构造函数一样的规则。

调用静态构造函数的时机：

- 调用显示声明的构造函数。
- 引用结构的静态成员。

##### 结构的构造方法和析构方法的使用

| 类型                 | 描述                                                   |
| -------------------- | ------------------------------------------------------ |
| 实例构造方法(无参数) | 不能再程序中声明，系统提供隐式的。不能被删除或重定义。 |
| 实例构造方法(有参数) | 可以在程序中声明。                                     |
| 静态析构方法         | 可以在程序中声明。                                     |
| 析构方法             | 不能在程序中声明，不允许声明析构方法。                 |

##### 结构作为返回值和参数

- 返回值：创建结构的副本。
- 值参数：创建实参结构的副本。
- ref和out：传入的是该结构的一个引用。



























